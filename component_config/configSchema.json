{
  "type": "object",
  "title": "Daktela Extractor Configuration",
  "required": [
    "connection",
    "data_selection"
  ],
  "properties": {
    "connection": {
      "type": "object",
      "title": "Connection",
      "required": [
        "url",
        "username",
        "#password"
      ],
      "properties": {
        "url": {
          "type": "string",
          "title": "URL",
          "description": "Daktela base URL (e.g., 'https://mycompany.daktela.com')",
          "propertyOrder": 1
        },
        "username": {
          "type": "string",
          "title": "Username",
          "description": "Daktela account username",
          "propertyOrder": 2
        },
        "#password": {
          "type": "string",
          "title": "Password",
          "description": "Daktela account password (encrypted)",
          "format": "password",
          "propertyOrder": 3
        },
        "verify_ssl": {
          "type": "boolean",
          "title": "Verify SSL Certificates",
          "description": "Enable SSL certificate verification. Disable only for testing with self-signed certificates. WARNING: Disabling SSL verification is insecure.",
          "format": "checkbox",
          "default": true,
          "propertyOrder": 4
        }
      },
      "propertyOrder": 1
    },
    "data_selection": {
      "type": "object",
      "title": "Data Selection",
      "required": [
        "date_from",
        "date_to",
        "endpoints"
      ],
      "properties": {
        "date_from": {
          "type": "string",
          "title": "Date From",
          "description": "Start date for extraction. Supported formats: 'today', 'yesterday', '5 hours ago', '3 days ago', '4 months ago', '2 years ago'. Used as filter for tickets, contacts, and activities endpoints.",
          "default": "7 days ago",
          "propertyOrder": 1
        },
        "date_to": {
          "type": "string",
          "title": "Date To",
          "description": "End date for extraction. Supported formats: 'today', 'yesterday', '5 hours ago', '3 days ago', '4 months ago', '2 years ago'. Used as filter for tickets, contacts, and activities endpoints.",
          "default": "today",
          "propertyOrder": 2
        },
        "discover_fields": {
          "type": "button",
          "format": "sync-action",
          "title": "Discover Available Fields",
          "options": {
            "async": {
              "label": "Discover Available Fields",
              "action": "listFields",
              "description": "Click to discover all available fields for all configured endpoints below. This will help you fill in the 'fields' property for each endpoint."
            }
          },
          "propertyOrder": 2.5
        },
        "endpoints": {
          "type": "array",
          "title": "Endpoints Configuration",
          "description": "Configure which endpoints to extract and which fields to include for each. Use 'Discover Available Fields' button above to see available fields, then specify them in each endpoint configuration.",
          "minItems": 1,
          "items": {
            "type": "object",
            "title": "Endpoint",
            "required": ["endpoint"],
            "properties": {
              "endpoint": {
                "type": "string",
                "title": "Endpoint",
                "description": "Select the API endpoint to extract",
                "enum": [
                  "accounts",
                  "activities",
                  "activitiesCall",
                  "activitiesChat",
                  "activitiesEmail",
                  "campaignsRecords",
                  "contacts",
                  "crmRecords",
                  "queues",
                  "statuses",
                  "tickets",
                  "users",
                  "groups",
                  "pauses",
                  "templates"
                ],
                "propertyOrder": 1
              },
              "fields": {
                "type": "array",
                "title": "Fields to Extract",
                "description": "Specify which fields to extract for this endpoint (leave empty to extract all fields). You can type field names manually or use the 'Discover Available Fields' button above to see all available fields.",
                "format": "select",
                "uniqueItems": true,
                "items": {
                  "type": "string"
                },
                "options": {
                  "tags": true
                },
                "propertyOrder": 2
              }
            }
          },
          "propertyOrder": 3
        }
      },
      "propertyOrder": 2
    },
    "destination": {
      "type": "object",
      "title": "Destination",
      "properties": {
        "incremental": {
          "type": "boolean",
          "title": "Incremental Load",
          "format": "checkbox",
          "description": "If enabled, new data will be appended to existing tables. If disabled, existing tables will be replaced.",
          "default": false,
          "propertyOrder": 1
        }
      },
      "propertyOrder": 3
    },
    "advanced": {
      "type": "object",
      "title": "Advanced",
      "description": "Advanced performance settings. Adjust these if you experience timeouts or memory issues.",
      "properties": {
        "batch_size": {
          "type": "integer",
          "title": "Batch Size",
          "description": "Number of records to request per API page and to flush to CSV in one chunk. Note: Daktela API has a maximum page size of 1000, so values above 1000 will be automatically capped.",
          "default": 1000,
          "minimum": 100,
          "maximum": 1000,
          "propertyOrder": 1
        },
        "max_concurrent_requests": {
          "type": "integer",
          "title": "Max Concurrent Requests",
          "description": "Maximum number of concurrent API requests. Controls how many HTTP calls can run in parallel across all endpoints. Increase for faster extraction, decrease if experiencing rate limiting.",
          "default": 10,
          "minimum": 1,
          "maximum": 50,
          "propertyOrder": 2
        },
        "max_concurrent_endpoints": {
          "type": "integer",
          "title": "Max Concurrent Endpoints",
          "description": "Maximum number of endpoints (tables) to extract simultaneously. Each endpoint holds data in memory, so lower values reduce memory usage. Increase for faster extraction on large backends with more memory.",
          "default": 3,
          "minimum": 1,
          "maximum": 20,
          "propertyOrder": 3
        }
      },
      "propertyOrder": 4
    },
    "debug": {
      "type": "boolean",
      "title": "Debug Mode",
      "format": "checkbox",
      "description": "If enabled, the component will produce detailed logs",
      "default": false,
      "propertyOrder": 5
    }
  }
}
